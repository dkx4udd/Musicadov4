<!-- UPDATED templates/index.liquid - Full Album Option Hidden -->
<!-- Language Detection Data -->
<script>
window.shopifyCustomerData = {
  {% if customer %}
    isLoggedIn: true,
    countryCode: {{ customer.default_address.country_code | default: 'unknown' | json }},
    {% if customer.orders.size > 0 %}
    lastOrderCountry: {{ customer.orders.first.billing_address.country_code | default: 'unknown' | json }},
    {% endif %}
  {% else %}
    isLoggedIn: false,
    countryCode: 'unknown',
  {% endif %}
  requestLocale: {{ request.locale.iso_code | json }},
  {% assign accept_lang = request.headers['Accept-Language'] | default: '' %}
  browserLanguageHeader: {{ accept_lang | json }}
};
console.log('üè™ Index page - Shopify customer data loaded:', window.shopifyCustomerData);
</script>

<!-- Cart Button and Language Switcher Header -->
<div class="top-navigation">
  <!-- Cart Button -->
  <div class="cart-button-container">
    <a href="/cart" id="cartButton" class="cart-button">
      <div class="cart-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 3H5L5.4 5M7 13H17L21 5H5.4M7 13L5.4 5M7 13L4.7 15.3C4.3 15.7 4.6 16.5 5.1 16.5H17M17 13V17C17 18.1 16.1 19 15 19H9C7.9 19 7 18.1 7 17V13M17 13H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span id="cartCount" class="cart-count">0</span>
      </div>
      <span id="cartText" class="cart-text" data-translate="cartEmpty">Winkelwagen Leeg</span>
    </a>
  </div>

  <!-- Language Switcher -->
  <div class="language-switcher">
    <button class="lang-btn active" data-lang="nl">NL</button>
    <button class="lang-btn" data-lang="en">EN</button>
  </div>
</div>

<div class="page active" id="page1">
  <div class="container">
    <div class="banner">
      {% comment %} Video banner option {% endcomment %}
      {% if settings.banner_video_url %}
        <video class="banner-video" autoplay muted loop playsinline>
          <source src="{{ settings.banner_video_url }}" type="video/mp4">
          {% if settings.banner_video_webm_url %}
            <source src="{{ settings.banner_video_webm_url }}" type="video/webm">
          {% endif %}
          {% comment %} Fallback image for browsers that don't support video {% endcomment %}
          {% if settings.banner_image %}
            <img src="{{ settings.banner_image | image_url: width: 1200 }}" alt="{{ settings.banner_title | escape }}">
          {% endif %}
        </video>
      {% elsif settings.banner_image %}
        <picture>
          <source media="(max-width: 480px)" srcset="{{ settings.banner_image | image_url: width: 480 }}">
          <source media="(max-width: 768px)" srcset="{{ settings.banner_image | image_url: width: 768 }}">
          <source media="(max-width: 1200px)" srcset="{{ settings.banner_image | image_url: width: 1200 }}">
          <img src="{{ settings.banner_image | image_url: width: 1920 }}" alt="{{ settings.banner_title | escape }}" class="banner-img">
        </picture>
      {% endif %}
      {% comment %} Banner title removed per user request {% endcomment %}
    </div>
    
    <!-- Intro Description Box -->
    <div class="card">
      <div class="intro-description">
        <p>
          Stop met saaie cadeautjes, Geef iets wat echte emoties brengt voor de prijs van een parfum
        </p>
      </div>
      
      <!-- Random Video Player -->
      <div class="subheadline-video-container">
        <video id="subheadlineVideo" playsinline>
          <source src="" type="video/mp4">
          Your browser does not support the video element.
        </video>
        <div class="video-controls">
          <button id="playPauseBtn" class="play-pause-btn">
            <svg class="play-icon" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8 5v14l11-7z"/>
            </svg>
            <svg class="pause-icon" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
              <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
            </svg>
          </button>
          <button id="muteBtn" class="mute-btn">
            <svg class="muted-icon" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
              <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
            </svg>
            <svg class="unmuted-icon" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
    
    <!-- Audio Examples Section -->
    <div class="card">
      <h2 class="audio-examples-title" data-translate="listenExamples">Listen to our examples</h2>
      <div class="audio-players">
        <div class="audio-player">
          <div class="audio-info">
            <h3 id="audioTitle1" data-translate="example1Title">Loading...</h3>
            <p id="audioDesc1" data-translate="example1Description">Random example from our collection</p>
          </div>
          <audio id="audioPlayer1" controls controlsList="nodownload" preload="metadata">
            <span data-translate="audioNotSupported">Your browser does not support the audio element.</span>
          </audio>
          <button onclick="loadRandomAudio(1)" class="btn audio-refresh-btn" data-translate="playAnother">üîÑ Play Another Example</button>
        </div>
        
        <div class="audio-player">
          <div class="audio-info">
            <h3 id="audioTitle2" data-translate="example2Title">Loading...</h3>
            <p id="audioDesc2" data-translate="example2Description">Random example from our collection</p>
          </div>
          <audio id="audioPlayer2" controls controlsList="nodownload" preload="metadata">
            <span data-translate="audioNotSupported">Your browser does not support the audio element.</span>
          </audio>
          <button onclick="loadRandomAudio(2)" class="btn audio-refresh-btn" data-translate="playAnother">üîÑ Play Another Example</button>
        </div>
      </div>
    </div>

    <!-- Dynamic Subheadline Section -->
    <div class="card">
      <div class="dynamic-subheadline-section">
        <h2 class="random-subheadline" id="randomSubheadline"></h2>
      </div>
    </div>

    <!-- Featured Testimonials Section -->
    <div class="card">
      <div class="featured-testimonials-container">
        <div class="featured-testimonials" id="featuredTestimonials">
          <div class="testimonial featured">
            <div class="testimonial-header">
              <img src="https://cdn.shopify.com/s/files/1/0905/1462/0749/files/test1.jpg" alt="Jennifer B." class="testimonial-avatar">
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            </div>
            <p class="testimonial-text" data-translate="featuredTestimonial1">Ik ga stuk. Mijn mams vond de tekst: Met Soesje op pad (Soesje is onze hond) echt superleuk en ze zingt het de hele dag!</p>
            <div class="customer-name">- Jennifer B.</div>
          </div>
          
          <div class="testimonial featured">
            <div class="testimonial-header">
              <img src="https://cdn.shopify.com/s/files/1/0905/1462/0749/files/test2.jpg" alt="Mark & Anna" class="testimonial-avatar">
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            </div>
            <p class="testimonial-text" data-translate="featuredTestimonial2">Moet zeggen dat ik eerst niet blij was. Na gesproken te hebben met de klantenservice, supergoed geholpen. En mijn collega was ook blij met het nummer. bedankt Musicado</p>
            <div class="customer-name">- Mark & Anna</div>
          </div>

          <div class="testimonial featured">
            <div class="testimonial-header">
              <img src="https://cdn.shopify.com/s/files/1/0905/1462/0749/files/test3.jpg" alt="David L." class="testimonial-avatar">
              <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            </div>
            <p class="testimonial-text" data-translate="featuredTestimonial3">Top! Mijn vrouw vond het leuk. Beter dan bloemen.</p>
            <div class="customer-name">- David L.</div>
          </div>
        </div>
        
        <!-- Mobile Navigation -->
        <div class="testimonials-nav mobile-only">
          <div class="nav-dots" id="testimonialDots">
            <span class="dot active" data-slide="0"></span>
            <span class="dot" data-slide="1"></span>
            <span class="dot" data-slide="2"></span>
          </div>
          <div class="swipe-hint" data-translate="swipeHint">‚Üê Swipe for more reviews ‚Üí</div>
        </div>
      </div>
      
      <!-- Success Banner -->
      <div class="success-banner">
        <div class="success-content">
          <div class="success-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <h3 class="success-text" data-translate="successBanner">Meer dan 500 luisteraars en tevreden muziekgenieters!</h3>
        </div>
      </div>
    </div>
    
    <div class="card">
      <div class="intro-text" data-translate="intro">
        Welcome to our professional music creation service! Choose your package and let us create custom songs just for you.
      </div>

      <form id="selectionForm">
        <!-- Package Selection - Full Album Option Hidden -->
        <div class="form-group">
          <label data-translate="selectPackage">Select your package:</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="package" value="one" id="pkg1" data-price="49">
              <label for="pkg1">
                <span data-translate="oneSong">One Song</span> - 
                <span class="price">‚Ç¨49</span>
              </label>
            </div>
            <div class="radio-option">
              <input type="radio" name="package" value="ep" id="pkg2" data-price="99">
              <label for="pkg2">
                <span data-translate="ep">EP (4 songs)</span> - 
                <span class="price">‚Ç¨99</span>
              </label>
            </div>
            <!-- TEMPORARILY HIDDEN: Full Album Option - Keep for future use -->
            <!--
            <div class="radio-option">
              <input type="radio" name="package" value="contact" id="pkgContact" data-price="contact">
              <label for="pkgContact">
                <span data-translate="fullAlbum">Full Album:</span> 
                <span data-translate="contactForPricing">Contact us for custom pricing</span>
              </label>
            </div>
            -->
          </div>
          <div class="package-disclaimer">
            <p data-translate="usageDisclaimer">All songs created can be used for personal use only, for commercial use, please contact us. We can publish your song on Spotify on your demand.</p>
          </div>
        </div>

        <!-- Music Style -->
        <div class="form-group">
          <label data-translate="musicStyles">Select your two favorite music styles:</label>
          <div class="form-row">
            <div class="form-group">
              <label for="musicStyle1" data-translate="firstMusicStyle">First Music Style *</label>
              <select id="musicStyle1" name="musicStyle1" required>
                <option value="" data-translate="selectOption">-- Select an option --</option>
                <option value="POP">POP</option>
                <option value="ROCK">ROCK</option>
                <option value="HIP_HOP_RAP">HIP/HOP RAP</option>
                <option value="ELECTRONIC">Electronic</option>
                <option value="LATIN">LATIN</option>
                <option value="CLASSICAL">CLASSICAL</option>
                <option value="COUNTRY">COUNTRY</option>
                <option value="JAZZ_BLUES">JAZZ/BLUES</option>
                <option value="METAL">METAL</option>
                <option value="REGGAE">REGGAE</option>
                <option value="LOCAL">LOCAL</option>
              </select>
            </div>
            <div class="form-group">
              <label for="musicStyle2" data-translate="secondMusicStyle">Second Music Style *</label>
              <select id="musicStyle2" name="musicStyle2" required>
                <option value="" data-translate="selectOption">-- Select an option --</option>
                <option value="POP">POP</option>
                <option value="ROCK">ROCK</option>
                <option value="HIP_HOP_RAP">HIP/HOP RAP</option>
                <option value="ELECTRONIC">Electronic</option>
                <option value="LATIN">LATIN</option>
                <option value="CLASSICAL">CLASSICAL</option>
                <option value="JAZZ_BLUES">JAZZ/BLUES</option>
                <option value="METAL">METAL</option>
                <option value="REGGAE">REGGAE</option>
                <option value="LOCAL">LOCAL</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Favorite Artists -->
        <div class="form-group">
          <label data-translate="favoriteArtists">Enter your favorite Artists:</label>
          <input type="text" name="artist1" placeholder="Artist 1" style="margin-bottom: 10px;">
          <input type="text" name="artist2" placeholder="Artist 2" style="margin-bottom: 10px;">
          <input type="text" name="artist3" placeholder="Artist 3">
        </div>

        <!-- Voice Selection -->
        <div class="form-group">
          <label data-translate="voiceSelection">Select voice preference:</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="voiceType" value="male" id="voiceMale">
              <label for="voiceMale">
                <span data-translate="maleVoice">Male Voice</span>
              </label>
            </div>
            <div class="radio-option">
              <input type="radio" name="voiceType" value="female" id="voiceFemale">
              <label for="voiceFemale">
                <span data-translate="femaleVoice">Female Voice</span>
              </label>
            </div>
            <div class="radio-option">
              <input type="radio" name="voiceType" value="no_preference" id="voiceNoPreference">
              <label for="voiceNoPreference">
                <span data-translate="noVoicePreference">No Preference</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Reason -->
        <div class="form-group">
          <label for="reason" data-translate="reason">Reason for this song:</label>
          <select id="reason" name="reason" required>
            <option value="" data-translate="selectOption">-- Select an option --</option>
            <option value="myself" data-translate="myself">For myself</option>
            <option value="love" data-translate="love">For my love</option>
            <option value="friend" data-translate="friend">For my friend</option>
            <option value="mom" data-translate="mom">For Mom</option>
            <option value="dad" data-translate="dad">For my dad</option>
            <option value="sibling" data-translate="sibling">For my Brother or Sister</option>
            <option value="other" data-translate="other">Other</option>
          </select>
          <input type="text" id="otherReason" name="otherReason" placeholder="Please specify" style="margin-top: 10px; display: none;">
        </div>

        <!-- Words/Names -->
        <div class="form-group" id="wordsSection">
          <label data-translate="wordsNames">What words or names would you like to have back in the songs:</label>
          <div id="wordsContainer">
            <!-- Words will be populated based on package selection -->
          </div>
        </div>

        <!-- Language -->
        <div class="form-group">
          <label for="songLanguage" data-translate="songLanguage">What language do you want the songs to be:</label>
          <select id="songLanguage" name="songLanguage" required>
            <option value="" data-translate="selectOption">-- Select an option --</option>
            <option value="dutch" data-translate="dutch">Dutch</option>
            <option value="english" data-translate="english">English</option>
            <option value="french" data-translate="french">French</option>
            <option value="german" data-translate="german">German</option>
            <option value="spanish" data-translate="spanish">Spanish</option>
            <option value="portuguese" data-translate="portuguese">Portuguese</option>
          </select>
        </div>

        <!-- Song Titles -->
        <div class="form-group song-titles" id="songTitles">
          <label data-translate="songTitles">Give the songs a title (leave blank for us to choose):</label>
          <div id="titleFields"></div>
        </div>

        <!-- Own Lyrics -->
        <div class="form-group">
          <label for="ownLyrics" data-translate="ownLyrics">Do you have your own lyrics or a story about the song: Enter here:</label>
          <textarea id="ownLyrics" name="ownLyrics" rows="5" placeholder="Enter your lyrics or story about the song here..." data-translate-placeholder="enterLyricsPlaceholder"></textarea>
        </div>

        <button type="submit" class="btn add-to-cart-btn" data-translate="addToCart">Add to Cart</button>
      </form>
    </div>

    <!-- Price Comparison Image Section -->
    <div class="card">
      <div class="comparison-image-container">
        <img src="https://cdn.shopify.com/s/files/1/0905/1462/0749/files/Parfumevsmusic.png" 
             alt="Parfum vs Music comparison" 
             class="comparison-image">
      </div>
    </div>

    <!-- Customer Testimonials Section -->
    <div class="card">
      <h2 class="testimonials-title" data-translate="customerReviews">What our customers say</h2>
      <div class="testimonials-grid">
        <div class="testimonial">
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <p class="testimonial-text" data-translate="testimonial1">"Amazing! They created the perfect love song for my anniversary. My partner was in tears - it was exactly what we dreamed of. Highly recommended!"</p>
          <div class="customer-name">- Sarah M.</div>
        </div>
        
        <div class="testimonial">
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <p class="testimonial-text" data-translate="testimonial2">"I ordered an EP for my mom's 60th birthday with family memories in the lyrics. The quality was outstanding and she plays it every day!"</p>
          <div class="customer-name">- Michael R.</div>
        </div>
        
        <div class="testimonial">
          <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <p class="testimonial-text" data-translate="testimonial3">"Professional service from start to finish. The rock album they made for our band sounds like it was produced in a major studio. Worth every euro!"</p>
          <div class="customer-name">- Lisa K.</div>
        </div>
      </div>
      
      <div class="rating-summary">
        <div class="overall-rating">
          <div class="big-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <div class="rating-text">
            <span class="rating-number">4.9/5</span>
            <span class="rating-label" data-translate="basedOnReviews">Based on 247+ reviews</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Admin Page -->
<div class="page" id="adminPage">
  <div class="container">
    <div class="card">
      <h2 data-translate="adminPanel">Admin Panel</h2>
      
      <div class="admin-controls">
        <button class="btn" onclick="MusicadoApp.showPage('page1')" data-translate="backToCustomer">Back to Customer</button>
        <button class="btn" onclick="MusicadoApp.exportToRTF()" data-translate="exportRTF">Export to RTF</button>
        <select id="orderFilter">
          <option value="all" data-translate="allOrders">All Orders</option>
          <option value="pending" data-translate="pending">Pending</option>
          <option value="completed" data-translate="completed">Completed</option>
        </select>
      </div>

      <div class="admin-panel">
        <h3 data-translate="addNewOrder">Add New Order Data</h3>
        <form id="adminForm">
          <div class="form-group">
            <label for="customerName" data-translate="customerName">Customer Name:</label>
            <input type="text" id="customerName" name="customerName" required>
          </div>
          <div class="form-group">
            <label for="customerEmail" data-translate="customerEmail">Customer Email:</label>
            <input type="email" id="customerEmail" name="customerEmail" required>
          </div>
          <div class="form-group">
            <label for="orderStatus" data-translate="orderStatus">Order Status:</label>
            <select id="orderStatus" name="orderStatus">
              <option value="pending" data-translate="pending">Pending</option>
              <option value="in_progress" data-translate="inProgress">In Progress</option>
              <option value="completed" data-translate="completed">Completed</option>
            </select>
          </div>
          <div class="form-group">
            <label for="notes" data-translate="notes">Notes:</label>
            <textarea id="notes" name="notes" rows="3"></textarea>
          </div>
          <button type="submit" class="btn" data-translate="addOrder">Add Order</button>
        </form>
      </div>

      <div class="data-table">
        <h3 data-translate="orderHistory">Order History</h3>
        <table id="ordersTable">
          <thead>
            <tr>
              <th data-translate="date">Date</th>
              <th data-translate="customer">Customer</th>
              <th data-translate="package">Package</th>
              <th data-translate="price">Price</th>
              <th data-translate="status">Status</th>
              <th data-translate="actions">Actions</th>
            </tr>
          </thead>
          <tbody id="ordersTableBody">
            <!-- Orders will be populated here -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Floating Buy Now Button -->
<button id="floatingBuyButton" class="floating-buy-button" data-translate="buyNow">Nu Kopen</button>

<!-- KEPT: Include the discount modal snippet (full album modal functionality preserved) -->
{% render 'discount-modal' %}

<!-- Include the main Musicado script -->
<script src="{{ 'musicado.js' | asset_url }}" defer></script>

<!-- Video Playlist Script -->
<script>
// Video URLs for playlist
const videoUrls = [
  'https://cdn.shopify.com/videos/c/o/v/4f1a6247ce5249959e5f1745d3770c44.mp4'
];

let currentVideoIndex = 0;

// Function to load next video in sequence
function loadNextVideo() {
  const videoPlayer = document.getElementById('subheadlineVideo');
  if (videoPlayer) {
    // Fade out
    videoPlayer.style.opacity = '0';
    
    setTimeout(() => {
      videoPlayer.src = videoUrls[currentVideoIndex];
      videoPlayer.load();
      
      // Fade in when video is ready
      videoPlayer.onloadeddata = function() {
        videoPlayer.style.opacity = '1';
        // Don't autoplay - wait for user to click play
        console.log('Video loaded and ready to play');
      };
    }, 300);
  }
}

// Play/Pause button functionality
function togglePlayPause() {
  const videoPlayer = document.getElementById('subheadlineVideo');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const playIcon = playPauseBtn.querySelector('.play-icon');
  const pauseIcon = playPauseBtn.querySelector('.pause-icon');
  
  if (videoPlayer.paused) {
    videoPlayer.play();
    playIcon.style.display = 'none';
    pauseIcon.style.display = 'block';
  } else {
    videoPlayer.pause();
    playIcon.style.display = 'block';
    pauseIcon.style.display = 'none';
  }
}

// Mute/Unmute button functionality
function toggleMute() {
  const videoPlayer = document.getElementById('subheadlineVideo');
  const muteBtn = document.getElementById('muteBtn');
  const mutedIcon = muteBtn.querySelector('.muted-icon');
  const unmutedIcon = muteBtn.querySelector('.unmuted-icon');
  
  if (videoPlayer.muted) {
    videoPlayer.muted = false;
    mutedIcon.style.display = 'none';
    unmutedIcon.style.display = 'block';
  } else {
    videoPlayer.muted = true;
    mutedIcon.style.display = 'block';
    unmutedIcon.style.display = 'none';
  }
}

// Set up video cycling
document.addEventListener('DOMContentLoaded', function() {
  const videoPlayer = document.getElementById('subheadlineVideo');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const muteBtn = document.getElementById('muteBtn');
  
  if (videoPlayer && playPauseBtn && muteBtn) {
    // Load first video
    loadNextVideo();
    
    // Add click listeners
    playPauseBtn.addEventListener('click', togglePlayPause);
    muteBtn.addEventListener('click', toggleMute);
    
    // When video ends, play next one (if there are multiple videos)
    videoPlayer.addEventListener('ended', function() {
      if (videoUrls.length > 1) {
        currentVideoIndex = (currentVideoIndex + 1) % videoUrls.length;
        loadNextVideo();
      } else {
        // Reset play button when single video ends
        const playIcon = playPauseBtn.querySelector('.play-icon');
        const pauseIcon = playPauseBtn.querySelector('.pause-icon');
        playIcon.style.display = 'block';
        pauseIcon.style.display = 'none';
      }
    });
    
    // Update button state when video play/pause state changes
    videoPlayer.addEventListener('play', function() {
      const playIcon = playPauseBtn.querySelector('.play-icon');
      const pauseIcon = playPauseBtn.querySelector('.pause-icon');
      playIcon.style.display = 'none';
      pauseIcon.style.display = 'block';
    });
    
    videoPlayer.addEventListener('pause', function() {
      const playIcon = playPauseBtn.querySelector('.play-icon');
      const pauseIcon = playPauseBtn.querySelector('.pause-icon');
      playIcon.style.display = 'block';
      pauseIcon.style.display = 'none';
    });
  }
});
</script>

<!-- Floating Buy Button Script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const floatingButton = document.getElementById('floatingBuyButton');
  const productSection = document.getElementById('selectionForm');
  
  // Show button immediately
  floatingButton.classList.add('show');
  
  // Smooth scroll to product section
  function scrollToProducts() {
    if (productSection) {
      const rect = productSection.getBoundingClientRect();
      const offset = window.scrollY + rect.top - 100; // 100px offset from top
      
      window.scrollTo({
        top: offset,
        behavior: 'smooth'
      });
    }
  }
  
  // Event listener for click
  floatingButton.addEventListener('click', scrollToProducts);
});
</script>

<!-- FIXED: Simplified cart integration script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('üöÄ Index page initializing with consistent Dutch default...');
  
  // Cart functionality only - no competing language detection
  function updateCartButton() {
    console.log('üõí Updating cart button...');
    
    // Fetch current cart state
    fetch('/cart.js')
      .then(response => response.json())
      .then(cart => {
        const cartCount = document.getElementById('cartCount');
        const cartText = document.getElementById('cartText');
        const cartButton = document.getElementById('cartButton');
        
        // Get current language from MusicadoApp
        const currentLang = (typeof MusicadoApp !== 'undefined' && MusicadoApp.currentLanguage) ? 
                           MusicadoApp.currentLanguage : 
                           localStorage.getItem('musicado_language') || 'nl';
        
        if (cart.item_count > 0) {
          if (cartCount) {
            cartCount.textContent = cart.item_count;
            cartCount.style.display = 'block';
          }
          if (cartText) {
            const itemText = currentLang === 'nl' ? 
              `${cart.item_count} items in winkelwagen` : 
              `${cart.item_count} items in cart`;
            cartText.textContent = itemText;
          }
          if (cartButton) {
            cartButton.classList.add('has-items');
          }
        } else {
          if (cartCount) {
            cartCount.style.display = 'none';
          }
          if (cartText) {
            cartText.textContent = currentLang === 'nl' ? 'Winkelwagen Leeg' : 'Cart Empty';
          }
          if (cartButton) {
            cartButton.classList.remove('has-items');
          }
        }
        
        console.log('‚úÖ Cart button updated:', cart.item_count, 'items');
      })
      .catch(error => {
        console.error('‚ùå Error updating cart:', error);
      });
  }
  
  // Setup cart button click analytics
  function setupCartButton() {
    const cartButton = document.getElementById('cartButton');
    if (cartButton) {
      cartButton.addEventListener('click', function(e) {
        console.log('üõí Cart button clicked');
      });
    }
  }
  
  // Setup language switcher to work with MusicadoApp
  function setupLanguageSwitcher() {
    document.querySelectorAll('.language-switcher .lang-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const selectedLang = e.target.dataset.lang;
        console.log('üîÑ Index page - Language switched to:', selectedLang);
        
        // Let MusicadoApp handle the language change
        if (typeof MusicadoApp !== 'undefined' && MusicadoApp.setLanguage) {
          // Update button states
          document.querySelectorAll('.language-switcher .lang-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          
          // Let MusicadoApp handle language setting and persistence
          MusicadoApp.setLanguage(selectedLang);
          
          // Update cart button with new language
          setTimeout(updateCartButton, 100);
        }
      });
    });
  }
  
  // Initialize when MusicadoApp is ready
  function initialize() {
    if (typeof MusicadoApp !== 'undefined') {
      console.log('‚úÖ MusicadoApp available, initializing index page features...');
      
      // Get current language from MusicadoApp (will be Dutch by default)
      const currentLang = MusicadoApp.currentLanguage || 'nl';
      
      // Update language button states to match MusicadoApp
      document.querySelectorAll('.language-switcher .lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === currentLang);
      });
      
      // Setup features
      setupLanguageSwitcher();
      setupCartButton();
      updateCartButton();
      
      // Update cart button periodically
      setInterval(updateCartButton, 5000);
      
      console.log('üéâ Index page initialization complete with language:', currentLang);
    } else {
      // Wait for MusicadoApp
      setTimeout(initialize, 100);
    }
  }
  
  // Start initialization
  initialize();
  
  // Make updateCartButton available globally
  window.updateCartButton = updateCartButton;
});
</script>

<!-- Styles for Top Navigation and Cart Button -->
<style>
/* Top Navigation Container */
.top-navigation {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background: rgba(30, 41, 59, 0.95);
  backdrop-filter: blur(15px) saturate(180%);
  border-bottom: 1px solid rgba(59, 130, 246, 0.3);
}

/* Cart Button */
.cart-button-container {
  display: flex;
  align-items: center;
}

.cart-button {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 20px;
  background: rgba(75, 85, 99, 0.8);
  border: 1px solid rgba(156, 163, 175, 0.3);
  border-radius: 12px;
  color: #e2e8f0;
  text-decoration: none;
  font-weight: 600;
  font-size: 14px;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.cart-button:hover {
  background: rgba(59, 130, 246, 0.8);
  border-color: rgba(59, 130, 246, 0.6);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
  color: white;
  text-decoration: none;
}

.cart-button.has-items {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  border-color: rgba(16, 185, 129, 0.6);
  color: white;
  box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
}

.cart-button.has-items:hover {
  background: linear-gradient(135deg, #059669 0%, #047857 100%);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
}

.cart-icon {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cart-icon svg {
  width: 22px;
  height: 22px;
  transition: transform 0.3s ease;
}

.cart-button:hover .cart-icon svg {
  transform: scale(1.1);
}

.cart-count {
  position: absolute;
  top: -8px;
  right: -8px;
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  color: white;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: none;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  line-height: 1;
  border: 2px solid white;
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.4);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.cart-count[style*="display: block"] {
  display: flex !important;
}

.cart-text {
  white-space: nowrap;
  font-weight: 600;
  letter-spacing: 0.025em;
}

/* Language Switcher - Matching Cart Page Style */
.language-switcher {
  display: flex;
  gap: 8px;
  background: rgba(30, 41, 59, 0.9);
  padding: 8px;
  border-radius: 12px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.lang-btn {
  padding: 8px 16px;
  background: rgba(75, 85, 99, 0.8);
  color: #e2e8f0;
  border: 1px solid rgba(156, 163, 175, 0.3);
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: all 0.3s ease;
  white-space: nowrap;
}

.lang-btn:hover {
  background: rgba(59, 130, 246, 0.8);
  border-color: rgba(59, 130, 246, 0.6);
  transform: translateY(-1px);
}

.lang-btn.active {
  background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
  border-color: rgba(59, 130, 246, 0.8);
  color: white;
  box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
}

/* Page content spacing to account for fixed top navigation */
.page {
  padding-top: 80px;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
  .top-navigation {
    padding: 10px 15px;
    flex-wrap: wrap;
    gap: 10px;
  }
  
  .cart-button {
    padding: 10px 16px;
    font-size: 12px;
    gap: 8px;
  }
  
  .cart-icon svg {
    width: 20px;
    height: 20px;
  }
  
  .cart-count {
    width: 18px;
    height: 18px;
    font-size: 10px;
    top: -6px;
    right: -6px;
  }
  
  .cart-text {
    display: none;
  }
  
  .language-switcher {
    padding: 6px;
    gap: 6px;
  }
  
  .lang-btn {
    padding: 6px 12px;
    font-size: 12px;
  }
  
  .page {
    padding-top: 70px;
  }
}

@media (max-width: 480px) {
  .top-navigation {
    padding: 8px 10px;
  }
  
  .cart-button {
    padding: 8px 12px;
    gap: 6px;
  }
  
  .cart-icon svg {
    width: 18px;
    height: 18px;
  }
  
  .language-switcher {
    padding: 4px;
  }
  
  .lang-btn {
    padding: 5px 8px;
    font-size: 10px;
  }
  
  .page {
    padding-top: 60px;
  }
}

/* Animation for cart updates */
.cart-button.updating {
  animation: cartUpdate 0.5s ease-in-out;
}

@keyframes cartUpdate {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

/* Ensure proper stacking context */
.top-navigation {
  z-index: 1000;
}

.discount-modal {
  z-index: 10000;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .cart-button,
  .lang-btn {
    border-width: 2px;
  }
  
  .cart-count {
    border-width: 3px;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .cart-button,
  .lang-btn,
  .cart-icon svg,
  .cart-count {
    transition: none;
    animation: none;
  }
}

/* Banner image responsive styles */
.banner {
  position: relative;
  overflow: hidden;
}

.banner-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  position: absolute;
  top: 0;
  left: 0;
}

/* Mobile banner fixes */
@media (max-width: 480px) {
  .banner {
    height: auto !important;
    min-height: 180px !important;
    max-height: 250px !important;
    background: #1e293b !important;
  }
  
  .banner picture,
  .banner img {
    position: relative !important;
    width: 100% !important;
    height: auto !important;
    object-fit: contain !important;
    max-height: 250px !important;
  }
  
}

@media (max-width: 360px) {
  .banner {
    min-height: 150px !important;
    max-height: 200px !important;
  }
  
  .banner picture,
  .banner img {
    max-height: 200px !important;
  }
}

/* Video Controls Styling */
.subheadline-video-container {
  position: relative;
  display: block;
  width: 100%;
  margin: 2rem auto;
  text-align: center;
}

.subheadline-video-container video {
  display: block;
  margin: 0 auto;
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.video-controls {
  position: absolute;
  bottom: 15px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  display: flex;
  gap: 15px;
  align-items: center;
}

.play-pause-btn,
.mute-btn {
  background: rgba(0, 0, 0, 0.7);
  border: 2px solid rgba(255, 255, 255, 0.8);
  border-radius: 50%;
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.play-pause-btn:hover,
.mute-btn:hover {
  background: rgba(0, 0, 0, 0.9);
  border-color: rgba(255, 255, 255, 1);
  transform: scale(1.1);
}

.play-pause-btn svg,
.mute-btn svg {
  width: 24px;
  height: 24px;
  color: white;
  transition: all 0.2s ease;
}

.play-pause-btn:active,
.mute-btn:active {
  transform: scale(0.95);
}

/* Mobile responsive controls */
@media (max-width: 768px) {
  .play-pause-btn,
  .mute-btn {
    width: 50px;
    height: 50px;
  }
  
  .play-pause-btn svg,
  .mute-btn svg {
    width: 20px;
    height: 20px;
  }
  
  .video-controls {
    gap: 10px;
  }
}

@media (max-width: 480px) {
  .play-pause-btn,
  .mute-btn {
    width: 45px;
    height: 45px;
  }
  
  .play-pause-btn svg,
  .mute-btn svg {
    width: 18px;
    height: 18px;
  }
  
  .video-controls {
    bottom: 10px;
    gap: 8px;
  }
}
</style>
